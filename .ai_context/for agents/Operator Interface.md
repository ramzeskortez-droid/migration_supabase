# Описание Интерфейса: Оператор (`/operator`)

Рабочее место для создания и первичной обработки заявок. Является "фронт-офисом" системы.
Реализовано в компоненте: `components/OperatorInterface.tsx`.

### 1.1. Аутентификация
- **Регистрация:** Теперь требует **Инвайт-код**, полученный у менеджера. Мастер-пароль удален.
- **Модерация:** После регистрации аккаунт ожидает подтверждения менеджера.
- **Демо-вход:** Кнопки "Женя" и "Ваня" для мгновенного входа.

## 2. Центральная панель: Обработка Заявок
Компоненты: `OrderInfoForm`, `PartsList`, `AiAssistant`, `SystemStatusHorizontal`.

### 2.1. Форма заказа (`OrderInfoForm.tsx`)
- **Почта клиента:** Поле с обязательной валидацией на наличие символов `@` и `.`. При неверном формате поле подсвечивается красным, а создание заказа блокируется.
- **Срок до:** Если оператор не указал дату вручную, при создании заказа система автоматически устанавливает дедлайн **+3 дня** от текущей даты.
- **Быстрый тест:** (Только в режиме DEBUG) Кнопка с молнией для автозаполнения формы случайными данными.

### 2.2. Блок "Файлы по заявке" (OrderFilesUpload)
- **Drag&Drop:** Область для перетаскивания файлов (PDF, Excel, Images и др.).
- **Отображение:** Загруженные файлы мгновенно появляются над зоной загрузки в виде строки с гиперссылками (например, `invoce.pdf, spec.xlsx`).
- **Удаление:** До создания заказа любой файл можно удалить из списка нажатием на крестик.
- **Сохранение:** При создании заказа ссылки на файлы сохраняются в БД и становятся доступны для просмотра Менеджеру и Закупщику.

### 2.3. ИИ-Ассистент (`AiAssistant.tsx`)
- **Эмуляция:** (Только в режиме DEBUG) Кнопка для вставки тестового текста письма.
- **Распознавание:** Отправляет текст в Groq API для извлечения структуры.

---

## 3. Правая панель: Почтовый ящик (`EmailWidget.tsx`)
Реализована в виде **сворачиваемого слайдера** (по умолчанию скрыт). Доступ по иконке почты справа.

### 3.1. Заголовок
- Отображает текущий ящик: **"Почтовый ящик china@nai.ru"**.

### 3.2. Действия
- **В Ассистент:** Кнопка доступна как в "Новых", так и в "Архиве". Позволяет передать текст письма в AI. При вызове из архива статус письма не меняется.

---

## 4. Список Заказов (`OperatorOrdersList.tsx`)

### 4.1. Колонки Листинга
- **№ Заказа:** Стиль `#ID` Indigo-600.
- **Почта:** Новая колонка, отображающая email клиента прямо в списке.
- **Сортировка:** Доступна по № Заказа, Клиенту, Сроку до (Deadline), Дате, Статусу.
- **Таб "Ручная":** Содержит заказы, переданные менеджером для ручной обработки. В этом режиме оператор видит все варианты цен и может копировать данные для отправки клиенту вручную.
- **Кнопка "Завершить обработку":** В ручном режиме переводит заказ в статус "Архив".

### 4.2. Детали Заказа
- **Инфо о клиенте:** Добавлена строка "Почта".
- **Сводный реестр файлов:** В блоке "Инфо о клиенте" (в раскрытом состоянии) отображается полный список всех файлов заказа, сгруппированный по разделам:
  - **Общие:** Файлы, прикрепленные ко всей заявке.
  - **Поз. N (Название):** Файлы, прикрепленные к конкретным позициям.
- **Копирование темы:** В развернутом виде рядом с темой письма добавлена кнопка "Копировать" с Toast-уведомлением.
- **Копирование позиции:** Формирует строку с данными товара и ценой победителя (если есть). Добавляет заголовок `Order #ID`.

---

## 5. Глобальный Чат (`GlobalChatWindow.tsx`)
- **Авто-Архивация:** Диалог уходит в архив через 7 дней после **последнего сообщения** или при смене статуса заказа.
- **Удаление:** Кнопка "Корзина" для мгновенного удаления.
- **Уведомления:** Всплывают в углу экрана на 1 секунду.