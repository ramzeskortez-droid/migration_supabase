# Bugs Log & Solutions

## 17.01.2026 - Ошибка 404/400 при утверждении заказа Менеджером
**Версия:** 1.18.115
**Проблема:** При нажатии кнопки "Утвердить КП" в консоли возникали ошибки `404 Not Found` (функция `approve_order_winners` не найдена) и затем `400 Bad Request` (колонки `delivery_weeks` не существует).
**Причина:** 
1. Функция финализации заказа `approve_order_winners` не была перенесена в новую базу Supabase.
2. В структуре `order_items` отсутствовало поле для хранения итогового срока, выбранного менеджером.
**Решение:** 
1. Написана и применена SQL-функция `approve_order_winners`, которая обновляет статусы и синхронизирует данные победителей.
2. В таблицу `order_items` добавлена колонка `delivery_weeks` (numeric).
**Статус:** Исправлено

## 17.01.2026 - Утечка доступа к Supabase Studio
**Версия:** 1.18.112
**Проблема:** При открытии порта 8001 для Studio она становилась доступна любому пользователю без пароля. Docker пробрасывал порт мимо UFW.
**Причина:** Специфика работы Docker с iptables.
**Решение:** 
1. Привязка порта Studio к `127.0.0.1` в `docker-compose`.
2. Проксирование через Nginx с модулем `auth_basic`.
**Статус:** Исправлено

... (остальное без изменений)