# Лог Багов и Решений

Этот файл служит базой знаний о проблемах, с которыми мы столкнулись, и о том, как они были решены.

---

## 10.01.2026 - Потеря файлов при создании Заявки и Оффера
**Версия:** 1.18.45 - 1.18.51
**Проблема:** 
1. Оператор загружает 2 файла в позицию + 2 общих файла. Менеджер видит только 1 файл в позиции (превью) и 2 общих.
2. Закупщик загружает 2 файла в позицию + 2 общих файла. Менеджер видит файлы позиций, но НЕ видит общие файлы закупщика.
3. Закупщик видит в блоке "Ваши файлы" файлы оператора (дублирование), хотя еще ничего не загружал.

**Причина:** 
1. **Оператор:** В компоненте `OperatorInterface.tsx` при сборе данных для отправки (`itemsForDb`) поле `itemFiles` (массив) просто не передавалось. Сервис получал `undefined` и записывал пустой массив, полагаясь на fallback `photoUrl` (один файл).
2. **Закупщик (Общие):** В `BuyerInterface.tsx` функция-обработчик `handleSubmitOffer` игнорировала аргумент `supplierFiles`, поэтому общие файлы не уходили на сервер.
3. **Закупщик (Дубли):** При инициализации формы оффера (`BuyerOrdersList.tsx`) поле `itemFiles` наследовалось от объекта заказа (файлы оператора), вместо того чтобы быть пустым.

**Решение:** 
1. **Оператор:** Добавлено поле `itemFiles: p.itemFiles` в маппинг `handleCreateOrder`.
2. **Закупщик:** Обновлена сигнатура `handleSubmitOffer`, проброшен аргумент `supplierFiles` в сервис.
3. **Закупщик:** Принудительно задано `itemFiles: []` при создании нового оффера. Разделены данные для отображения (`operatorItemFiles` для инфо оператора) и редактирования.
4. **UI Менеджера:** В `AdminOrdersList` переименован блок "Файлы от поставщиков" -> "Файлы от закупщиков".

**Статус:** Исправлено (подтверждено пользователем).
