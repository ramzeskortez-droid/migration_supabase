# Version History

## 1.18.120 - Feature: Offer Amendment & Locking System
- **Buyer Workflow:**
  - Реализована кнопка "Изменить / Дополнить" для уже отправленных предложений.
  - Внедрена система блокировок (`locked_at` в БД), оповещающая менеджера о процессе правки.
  - Добавлена логика автоматического возврата из таба "Архив / Отказ" в "В торгах" при успешном исправлении предложения.
  - Внедрена защита от правок в последний момент перед дедлайном (скрытие кнопки за `Timeout + 2 мин`).
- **Database & API:**
  - В таблицу `offers` добавлена колонка `locked_at`.
  - Добавлены RPC-функции `lock_offer` и `unlock_offer`.
  - В таблицу `offer_items` добавлен уникальный индекс `(offer_id, order_item_id)` для стабильного обновления данных через `upsert`.
  - В `fetch.ts` добавлена загрузка поля `weight` для офферов (ранее сбрасывалось).
- **Admin Interface:**
  - В настройки добавлена регулировка времени на редактирование (таймаут).
  - (В процессе) Реализация визуальных оверлеев на офферах при активном `locked_at`.

## 1.18.119 - UI Polishing: Neutral Initial Validation
- **Buyer Interface:**
  - Поля закупщика теперь выглядят нейтрально (без красных рамок и звездочек) при открытии заказа.
  - Валидация активируется точечно только для тех позиций, где введена цена (> 0).
- **Fixes:**
  - Исправлена ошибка загрузки нескольких файлов (race condition) и двойной дроп.
  - Улучшено позиционирование уведомлений (Toast) через Portals.

## 1.18.118 - Fix: Buyer Dashboard Data Structure
... (остальное без изменений)
