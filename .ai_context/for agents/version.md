# Version History

## 1.18.133 - Fix: Toast Portal
- **Global UI:**
  - Компонент `Toast` переведен на React Portal (`createPortal`). Это окончательно решает проблему перекрытия уведомлений другими элементами интерфейса (шапкой, модалками), так как рендер происходит в корень `body`.

## 1.18.132 - Admin: Brands Export & Toast Fix
- **Admin Interface:**
  - Реализован экспорт таблицы брендов в Excel (.xlsx).
  - Добавлено модальное окно с выбором диапазона дат (Начало - Конец).
  - Интеграция библиотеки `xlsx` для генерации отчетов на клиенте.
- **Global UI:**
  - Исправлен z-index уведомлений Toast (увеличен до 9999), чтобы они не перекрывались шапкой.

## 1.18.131 - UX: Buyer Refusal & Comments
- **Buyer Interface:**
  - **Свернутый отказ:** Карточка позиции со статусом "Отказ" (Quantity = 0) теперь отображается компактно (красный фон, перечеркнутый текст заголовка), скрывая инпуты. Клик по блоку возвращает позицию в работу.
  - **Авто-отказ:** При отправке КП с незаполненными позициями появляется модальное окно с предложением автоматически пометить их как "Отказ".
  - **Валидация:** Поля "Комментарий" и "WeChat ID" подсвечиваются как обязательные (красная обводка) только если введена цена.
- **Manager Interface:**
  - В развернутом оффере добавлены поля "Комментарий" и "WeChat ID" под строкой варианта с возможностью их редактирования.
  - Исправлены стили отображения WeChat ID.
- **Operator Interface:**
  - Добавлен вывод комментария (от закупщика или менеджера) под каждым вариантом в списке товаров.
  - Комментарий включен в текст при копировании (позиции и всего заказа).

## 1.18.127 - Logic: Unit Pricing for Clients
- **Admin Interface:**
  - **Ценообразование:** Итоговая цена для клиента теперь всегда рассчитывается и отображается **за 1 единицу товара** (Unit Price). Убрано умножение на количество во всей системе.
  - **Финансы:** Из калькулятора на странице Финансов удалено поле "Кол-во" и блок расчета "ИТОГО ЗА ПАРТИЮ". Формула теперь нацелена исключительно на стоимость за штуку.
- **Documentation:**
  - Обновлены файлы `Project Description.md` и `Manager Interface.md` с учетом перехода на Unit Pricing.

## 1.18.126 - UI: Copy Buttons & Listing Optimization
- **Global UI:**
  - Добавлены кнопки быстрого копирования (CopyButton) слева от Наименования и Артикула во всех списках товаров (Менеджер, Оператор, Закупщик).
  - Унифицирован стиль Наименования товара: уменьшен шрифт до размера артикула (text-[10px]), но сохранена жирность (font-black).
  - Внедрено жесткое ограничение длины наименования в списках до 40 символов (обрезается с троеточием), полное название доступно при наведении (title).

## 1.18.125 - Fix: deliveryWeeks -> clientDeliveryWeeks Sync
- **Admin Interface:** Исправлена логика редактирования срока — теперь Менеджер обновляет итоговое значение напрямую в БД, что исключает повторное наложение формулы "+ к сроку".
- **Operator Interface:** В функции копирования теперь используются утвержденные менеджером сроки (clientDeliveryWeeks).

## 1.18.124 - Logic: Buyer Delivery Time Calculation
- **Buyer Workflow:** Валидация срока изменена на Min 1. Реализована фиксация client_delivery_weeks при создании оффера.
