# Глобальные правила (System Rules)

**Эти правила являются обязательными к исполнению во всех задачах.**

1. **Язык и Стиль:**
   - Русский язык для всех ответов, комментариев и документации.
   - Стиль общения: Профессиональный, лаконичный.

2. **Безопасность кода:**
   - Не вносить изменений вне контекста текущей задачи.
   - О критических архитектурных изменениях предупреждать заранее.

3. **Технологический стек (Strict):**
   - **Backend:** Supabase (PostgreSQL). Прямое взаимодействие через `supabaseClient.ts`.
   - **State:** React Query v5. Обязательное использование `invalidateQueries` после мутаций.
   - **UI:** Tailwind CSS. Строгое соблюдение текущей цветовой схемы и сетки.

4. **Работа с документацией (КРИТИЧНО):**
   - Папка `for agents` — **основной источник знаний**.
   - **ОБЯЗАННОСТЬ:** При изменении UI (добавление кнопок, полей, изменение верстки или поведения элементов) ты ОБЯЗАН обновить соответствующий файл:
     - `Operator Interface.md`
     - `Buyer Interface.md`
     - `Manager Interface.md`
   - При изменении бизнес-логики или потоков данных обновляй `Interaction and Logic.md`.
   - При появлении новых терминов обновляй `Technical Terms.md`.

5. **Терминология и Роли:**
   - **Менеджер (Manager):** Управление ценами и воронкой.
   - **Закупщик (Buyer):** Подача ценовых предложений (офферов).
   - **Оператор (Operator):** Ввод и первичная обработка заявок.
   - **Order:** Заявка клиента.
   - **Offer:** Предложение от закупщика.

6. **Принципы разработки:**
   - **Изоляция:** Строгая проверка `owner_token` для Оператора.
   - **Валидация:** Проверка брендов по справочнику, санитарная очистка вводимых данных (особенно цен и телефонов).
   - **Real-time:** Обеспечение актуальности данных (через polling или подписки Supabase).

7. **Отчетность и GIT:**
   - По завершении: краткий список "Что сделано" и блок "Как проверить".
   - Сообщения коммитов (Git) — **только на русском языке**.
   - **Обязательная структура коммита:**
     1. **Заголовок:** `ВЕРСИЯ [X.X.X] - [Краткое название]`
     2. **Описание:** Детальный перечень изменений.
     3. **Блок "БЫЛА ПРОБЛЕМА":** Четкое описание бага или отсутствующей функции.
     4. **Блок "КАК РЕШИЛИ":** Техническое описание реализации или исправления.