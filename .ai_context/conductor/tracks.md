# Tracks

## Текущий статус: Активная разработка (Эпик: Финансы и Роли)

---

## Активный трек: Финансы, Изоляция и Закупщик 2.0
**Цель:** Реализовать ролевую модель (Админ/Оператор/Закупщик), управление курсами валют и изоляцию данных.

**План действий:**
1. **База данных (Step 1):**
   - [x] Создание таблиц `app_users`, `exchange_rates`, `buyer_order_labels`.
   - [x] Модификация `orders` (owner_token) и `order_items` (admin_price_rub).
   - [x] SQL миграция `30_epic_finance_roles_isolation.sql`.
2. **Бэкенд (Service Layer):**
   - [ ] Метод `loginWithToken`.
   - [ ] Методы для работы с курсами (get/upsert).
   - [ ] Логика простановки `owner_token` при создании заказа.
   - [ ] Получение "Лучшей цены" для закупщика.
3. **Интерфейс Админа (Финансы):**
   - [ ] Страница настройки курсов валют.
   - [ ] Редактирование цены (карандашик) в деталях заказа.
4. **Интерфейс Оператора:**
   - [ ] Экран входа (Token Auth).
   - [ ] Изоляция списков (видит только свои).
5. **Интерфейс Закупщика:**
   - [ ] Переименование `/supplier` -> `/buyer`.
   - [ ] Система стикеров.
   - [ ] Таб "Горящие".

---

## Завершенный трек: Интерфейс Оператора 2.0 и ИИ (Январь 2026)

**Цель:** Создать современный, быстрый интерфейс для создания заявок с использованием ИИ.

**Выполнено:**
- **Архитектура:** Создан новый модуль `components/operator` (Header, OrdersList, OrderInfo, PartsList).
- **ИИ-Ассистент:** Интегрирован Groq API для парсинга текста заявки (выделение позиций, контактов, темы письма).
- **Работа с брендами:**
  - Создана таблица `brands` (3000+ записей).
  - Реализован **нечеткий поиск** (Fuzzy search) при вводе бренда.
  - Подсветка неизвестных брендов и быстрое добавление в базу.
- **UI/UX:**
  - Табличный листинг заказов в стиле Поставщика (Virtualization).
  - Бесконечный скролл (Infinite Scroll) с подгрузкой данных.
  - Мгновенная отправка сообщений в чате (Optimistic UI).
  - Валидация полей ввода.

---

## Завершенный трек: Виртуализация списков

**Цель:** Обеспечить плавную работу списков заказов при большом количестве данных.

**Выполнено:**
- Установлена библиотека `react-virtuoso`.
- Переработан `AdminOrdersList.tsx` и `SellerOrdersList.tsx`.
- Внедрен виртуальный скроллинг и мемоизация строк.

---

## Бэклог (Идеи на будущее)
- [ ] Серверная пагинация для админки (сейчас грузится всё/много).
- [ ] Улучшение парсинга ИИ (обучение на примерах).
- [ ] Ролевая модель (защита роутов на сервере/клиенте).