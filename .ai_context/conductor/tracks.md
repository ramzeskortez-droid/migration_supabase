# Tracks

## Текущий трек: Доработка функционала чата

**Цель:** Исправить сброс счетчика непрочитанных и добавить возможность удаления чатов админом.

**Контекст:**
- Счетчик не сбрасывался у Поставщика.
- Админу требовалась функция очистки чатов.

**Решение:**
1.  **Сброс счетчика:**
    - В `ChatWindow.tsx` добавлена проверка роли. Если текущий пользователь `SUPPLIER`, то помечаются прочитанными сообщения от `ADMIN`.
    - В `SupabaseService.ts` метод `markChatAsRead` теперь принимает роль читателя (`readerRole`) и обновляет статус только нужных сообщений.
2.  **Удаление чатов:**
    - В `SupabaseService.ts` добавлен метод `deleteChatHistory(orderId, supplierName?)`.
    - В `AdminGlobalChat.tsx` добавлены кнопки "крестик" (X).
        - На строке заказа: удаляет *все* чаты по этому заказу.
        - На строке поставщика: удаляет переписку только с этим поставщиком.

**Статус:** Завершено.